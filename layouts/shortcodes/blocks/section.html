{{- $_hugo_config := `{ "version": 1 }` -}}
{{- $col_id := .Get "color" | default .Ordinal -}}
{{- $height := .Get "height" | default "auto"  -}}
{{- $type   := .Get "type" | default "" -}}
{{- $style := .Get "style" -}}
{{- $id_fallback := ( printf "td-block-%d" .Ordinal ) -}}
{{- $id := .Get "id" | default (printf "%s%s" $id_fallback "-section" ) -}}
{{- $class := .Get "class" -}}
{{/* special case Kubernetes overview */}}
{{- if eq $class "k8s-overview" -}}
 {{- partial "kubernetes-overview.html" (dict "id" $id "class" $class "inner" $.Inner ) -}}
{{- else -}}
{{- $backgroundImage := false -}}
{{- with (.Get "background-image") -}}
  {{- with resources.Get (printf "images/site-blocks/%s.jpeg" . ) -}}
    {{- $backgroundImage = . -}}
  {{- else -}}
    {{- errorf "Section background image %q not found" $.name -}}
  {{- end -}}
{{- else -}}
{{- end -}}
<a id="{{ $id_fallback }}" class="td-offset-anchor"></a>
<section id="{{ $id }}" class="row td-box td-box--{{ $col_id }} td-box--gradient td-box--height-{{ $height }}{{ with $class }} {{ . }}{{ end }}{{ with $backgroundImage }} section-with-bgimage {{ end }}" style="{{ with $backgroundImage }}background-image: url({{ .Permalink }}); {{ end }}{{ with $style }}{{ . | safeCSS }}{{ end }}">
	<div class="col">
		<div class="row {{ $type }}">
			{{ if eq .Page.File.Ext "md" }}
				{{ .Inner | markdownify }}
			{{ else }}
				{{ .Inner | htmlUnescape | safeHTML }}
			{{ end }}
		</div>
	</div>
</section>
{{- end -}}
