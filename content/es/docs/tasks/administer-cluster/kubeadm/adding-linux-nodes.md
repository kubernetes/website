---
title: Agregar nodos worker Linux
content_type: task
weight: 10
---

<!-- overview -->

Esta página explica cómo agregar nodos worker Linux a un clúster de kubeadm.

## {{% heading "prerequisites" %}}

* Cada nodo worker que se une tiene instalados los componentes requeridos de
[Instalando kubeadm](/docs/setup/production-environment/tools/kubeadm/install-kubeadm/), como
kubeadm, el kubelet y un {{< glossary_tooltip term_id="container-runtime" text="runtime de contenedores" >}}.
* Un clúster kubeadm en ejecución creado por `kubeadm init` y siguiendo los pasos
en el documento [Crear un clúster con kubeadm](/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/).
* Necesitas acceso de superusuario al nodo.

<!-- steps -->

## Agregar nodos worker Linux

Para agregar nuevos nodos worker Linux a tu clúster haz lo siguiente en cada máquina:

1. Conéctate a la máquina usando SSH u otro método.
1. Ejecuta el comando que fue mostrado por `kubeadm init`. Por ejemplo:

  ```bash
  sudo kubeadm join --token <token> <control-plane-host>:<control-plane-port> --discovery-token-ca-cert-hash sha256:<hash>
  ```

### Información adicional para kubeadm join

{{< note >}}
Para especificar una tupla IPv6 para `<control-plane-host>:<control-plane-port>`, la dirección IPv6 debe ir entre corchetes, por ejemplo: `[2001:db8::101]:2073`.
{{< /note >}}

Si no tienes el token, puedes obtenerlo ejecutando el siguiente comando en el nodo de control plane:

```bash
# Ejecuta esto en un nodo de control plane
sudo kubeadm token list
```

La salida es similar a esto:

```console
TOKEN                    TTL  EXPIRES              USAGES           DESCRIPTION            EXTRA GROUPS
8ewj1p.9r9hcjoqgajrj4gi  23h  2018-06-12T02:51:28Z authentication,  The default bootstrap  system:
                                                   signing          token generated by     bootstrappers:
                                                                    'kubeadm init'.        kubeadm:
                                                                                           default-node-token
```

Por defecto, los tokens para unir nodos expiran después de 24 horas. Si vas a unir un nodo al clúster después de que
el token actual haya expirado, puedes crear uno nuevo ejecutando el siguiente comando en el
nodo de control plane:

```bash
# Ejecuta esto en un nodo de control plane
sudo kubeadm token create
```

La salida es similar a esto:

```console
5didvk.d09sbcov8ph2amjw
```

Si no tienes el valor de `--discovery-token-ca-cert-hash`, puedes obtenerlo ejecutando los
siguientes comandos en el nodo de control plane:

```bash
# Ejecuta esto en un nodo de control plane
sudo cat /etc/kubernetes/pki/ca.crt | openssl x509 -pubkey  | openssl rsa -pubin -outform der 2>/dev/null | \
   openssl dgst -sha256 -hex | sed 's/^.* //'
```

La salida es similar a:

```console
8cb2de97839780a412b93877f8507ad6c94f73add17d5d7058e91741c9d5ec78
```

La salida del comando `kubeadm join` debería verse algo así:

```
[preflight] Running pre-flight checks

... (log output of join workflow) ...

Node join complete:
* Certificate signing request sent to control-plane and response
  received.
* Kubelet informed of new secure connection details.

Run 'kubectl get nodes' on control-plane to see this machine join.
```

Unos segundos después, deberías ver este nodo en la salida de `kubectl get nodes`.
(por ejemplo, ejecuta `kubectl` en un nodo de control plane).

{{< note >}}
Como los nodos del clúster usualmente se inicializan secuencialmente, los Pods de CoreDNS probablemente se ejecuten todos
en el primer nodo de control plane. Para mayor alta disponibilidad, por favor rebalancea los Pods de CoreDNS
con `kubectl -n kube-system rollout restart deployment coredns` después de unir al menos un nuevo nodo.
{{< /note >}}

## {{% heading "whatsnext" %}}

* Mira cómo [agregar nodos worker Windows](/docs/tasks/administer-cluster/kubeadm/adding-windows-nodes/).