---
layout: blog
title: 'Kubernetes 1.29 中的移除、棄用和主要變更'
date: 2023-11-16
slug: kubernetes-1-29-upcoming-changes
---
<!--
layout: blog
title: 'Kubernetes Removals, Deprecations, and Major Changes in Kubernetes 1.29'
date: 2023-11-16
slug: kubernetes-1-29-upcoming-changes
-->

<!--
**Authors:** Carol Valencia, Kristin Martin, Abigail McCarthy, James Quigley, Hosam Kamel
-->
**作者:** Carol Valencia, Kristin Martin, Abigail McCarthy, James Quigley, Hosam Kamel

**譯者:** [Michael Yao](https://github.com/windsonsea) (DaoCloud)

<!--
As with every release, Kubernetes v1.29 will introduce feature deprecations and removals. Our continued ability to produce high-quality releases is a testament to our robust development cycle and healthy community. The following are some of the deprecations and removals coming in the Kubernetes 1.29 release.
-->
和其他每次發佈一樣，Kubernetes v1.29 將棄用和移除一些特性。
一貫以來生成高質量發佈版本的能力是開發週期穩健和社區健康的證明。
下文列舉即將發佈的 Kubernetes 1.29 中的一些棄用和移除事項。

<!--
## The Kubernetes API removal and deprecation process

The Kubernetes project has a well-documented deprecation policy for features. This policy states that stable APIs may only be deprecated when a newer, stable version of that same API is available and that APIs have a minimum lifetime for each stability level. A deprecated API is one that has been marked for removal in a future Kubernetes release; it will continue to function until removal (at least one year from the deprecation), but usage will result in a warning being displayed. Removed APIs are no longer available in the current version, at which point you must migrate to using the replacement.
-->
## Kubernetes API 移除和棄用流程

Kubernetes 項目對特性有一個文檔完備的棄用策略。此策略規定，只有當同一 API 有了較新的、穩定的版本可用時，
原有的穩定 API 纔可以被棄用，各個不同穩定級別的 API 都有一個最短的生命週期。
棄用的 API 指的是已標記爲將在後續某個 Kubernetes 發行版本中被移除的 API；
移除之前該 API 將繼續發揮作用（從被棄用起至少一年時間），但使用時會顯示一條警告。
被移除的 API 將在當前版本中不再可用，此時你必須轉爲使用替代的 API。

<!--
* Generally available (GA) or stable API versions may be marked as deprecated, but must not be removed within a major version of Kubernetes.
* Beta or pre-release API versions must be supported for 3 releases after deprecation.
* Alpha or experimental API versions may be removed in any release without prior deprecation notice.
-->
- 正式發佈（GA）或穩定的 API 版本可能被標記爲已棄用，但只有在 Kubernetes 主版本變化時纔會被移除。
- 測試版（Beta）或預發佈 API 版本在棄用後必須在後續 3 個版本中繼續支持。
- Alpha 或實驗性 API 版本可以在任何版本中被移除，不另行通知。

<!--
Whether an API is removed as a result of a feature graduating from beta to stable or because that API simply did not succeed, all removals comply with this deprecation policy. Whenever an API is removed, migration options are communicated in the documentation.
-->
無論一個 API 是因爲某特性從 Beta 進階至穩定階段而被移除，還是因爲該 API 根本沒有成功，
所有移除均遵從上述棄用策略。無論何時移除一個 API，文檔中都會列出遷移選項。

<!--
## A note about the k8s.gcr.io redirect to registry.k8s.io

To host its container images, the Kubernetes project uses a community-owned image registry called registry.k8s.io. Starting last March traffic to the old k8s.gcr.io registry began being redirected to registry.k8s.io. The deprecated k8s.gcr.io registry will eventually be phased out. For more details on this change or to see if you are impacted, please read [k8s.gcr.io Redirect to registry.k8s.io - What You Need to Know](/blog/2023/03/10/image-registry-redirect/).
-->
## k8s.gcr.io 重定向到 registry.k8s.io 相關說明

Kubernetes 項目爲了託管其容器映像檔，使用社區自治的一個名爲 registry.k8s.io 的映像檔倉庫。
從最近的 3 月份起，所有流向 k8s.gcr.io 舊倉庫的請求開始被重定向到 registry.k8s.io。
已棄用的 k8s.gcr.io 倉庫最終將被淘汰。有關這一變更的細節或若想查看你是否受到影響，參閱
[k8s.gcr.io 重定向到 registry.k8s.io - 使用者須知](/zh-cn/blog/2023/03/10/image-registry-redirect/)。

<!--
## A note about the Kubernetes community-owned package repositories

Earlier in 2023, the Kubernetes project [introduced](/blog/2023/08/15/pkgs-k8s-io-introduction/) `pkgs.k8s.io`, community-owned software repositories for Debian and RPM packages. The community-owned repositories replaced the legacy Google-owned repositories (`apt.kubernetes.io` and `yum.kubernetes.io`).
On September 13, 2023, those legacy repositories were formally deprecated and their contents frozen.
-->
## Kubernetes 社區自治軟件包倉庫相關說明

在 2023 年年初，Kubernetes 項目[引入了](/zh-cn/blog/2023/08/15/pkgs-k8s-io-introduction/) `pkgs.k8s.io`,
這是 Debian 和 RPM 軟件包所用的社區自治軟件包倉庫。這些社區自治的軟件包倉庫取代了先前由 Google 管理的倉庫
（`apt.kubernetes.io` 和 `yum.kubernetes.io`）。在 2023 年 9 月 13 日，這些老舊的倉庫被正式棄用，其內容被凍結。

<!--
For more information on this change or to see if you are impacted, please read the [deprecation announcement](/blog/2023/08/31/legacy-package-repository-deprecation/).
-->
有關這一變更的細節或你若想查看是否受到影響，
請參閱[棄用公告](/zh-cn/blog/2023/08/31/legacy-package-repository-deprecation/)。

<!--
## Deprecations and removals for Kubernetes v1.29

See the official list of [API removals](/docs/reference/using-api/deprecation-guide/#v1-29) for a full list of planned deprecations for Kubernetes v1.29.
-->
## Kubernetes v1.29 的棄用和移除說明

有關 Kubernetes v1.29 計劃棄用的完整列表，
參見官方 [API 移除](/zh-cn/docs/reference/using-api/deprecation-guide/#v1-29)列表。

<!--
### Removal of in-tree integrations with cloud providers ([KEP-2395](https://kep.k8s.io/2395))

The [feature gates](/docs/reference/command-line-tools-reference/feature-gates/) `DisableCloudProviders` and `DisableKubeletCloudCredentialProviders` will both be set to `true` by default for Kubernetes v1.29. This change will require that users who are currently using in-tree cloud provider integrations (Azure, GCE, or vSphere) enable external cloud controller managers, or opt in to the legacy integration by setting the associated feature gates to `false`.
-->
### 移除與雲驅動的內部集成（[KEP-2395](https://kep.k8s.io/2395)）

對於 Kubernetes v1.29，默認特性門控 `DisableCloudProviders` 和 `DisableKubeletCloudCredentialProviders`
都將被設置爲 `true`。這個變更將要求當前正在使用內部雲驅動集成（Azure、GCE 或 vSphere）的使用者啓用外部雲控制器管理器，
或者將關聯的特性門控設置爲 `false` 以選擇傳統的集成方式。

<!--
Enabling external cloud controller managers means you must run a suitable cloud controller manager within your cluster's control plane; it also requires setting the command line argument `--cloud-provider=external` for the kubelet (on every relevant node), and across the control plane (kube-apiserver and kube-controller-manager).
-->
啓用外部雲控制器管理器意味着你必須在叢集的控制平面中運行一個合適的雲控制器管理器；
同時還需要爲 kubelet（在每個相關節點上）及整個控制平面（kube-apiserver 和 kube-controller-manager）
設置命令列參數 `--cloud-provider=external`。

<!--
For more information about how to enable and run external cloud controller managers, read [Cloud Controller Manager Administration](/docs/tasks/administer-cluster/running-cloud-controller/) and [Migrate Replicated Control Plane To Use Cloud Controller Manager](/docs/tasks/administer-cluster/controller-manager-leader-migration/).

For general information about cloud controller managers, please see
[Cloud Controller Manager](/docs/concepts/architecture/cloud-controller/) in the Kubernetes documentation.
-->
有關如何啓用和運行外部雲控制器管理器的細節，
參閱[管理雲控制器管理器](/zh-cn/docs/tasks/administer-cluster/running-cloud-controller/)和
[遷移多副本的控制面以使用雲控制器管理器](/zh-cn/docs/tasks/administer-cluster/controller-manager-leader-migration/)。

有關雲控制器管理器的常規信息，請參閱 Kubernetes
文檔中的[雲控制器管理器](/zh-cn/docs/concepts/architecture/cloud-controller/)。

<!--
### Removal of the `v1beta2` flow control API group

The _flowcontrol.apiserver.k8s.io/v1beta2_ API version of FlowSchema and PriorityLevelConfiguration will [no longer be served](/docs/reference/using-api/deprecation-guide/#v1-29) in Kubernetes v1.29. 

To prepare for this, you can edit your existing manifests and rewrite client software to use the `flowcontrol.apiserver.k8s.io/v1beta3` API version, available since v1.26. All existing persisted objects are accessible via the new API. Notable changes in `flowcontrol.apiserver.k8s.io/v1beta3` include
that the PriorityLevelConfiguration `spec.limited.assuredConcurrencyShares` field was renamed to `spec.limited.nominalConcurrencyShares`.
-->
### 移除 `v1beta2` 流量控制 API 組

在 Kubernetes v1.29 中，將[不再提供](/zh-cn/docs/reference/using-api/deprecation-guide/#v1-29)
FlowSchema 和 PriorityLevelConfiguration 的 **flowcontrol.apiserver.k8s.io/v1beta2** API 版本。

爲了做好準備，你可以編輯現有的清單（Manifest）並重寫客戶端軟件，以使用自 v1.26 起可用的
`flowcontrol.apiserver.k8s.io/v1beta3` API 版本。所有現有的持久化對象都可以通過新的 API 訪問。
`flowcontrol.apiserver.k8s.io/v1beta3` 中的顯著變化包括將 PriorityLevelConfiguration 的
`spec.limited.assuredConcurrencyShares` 字段更名爲 `spec.limited.nominalConcurrencyShares`。

<!--
### Deprecation of the `status.nodeInfo.kubeProxyVersion` field for Node

The `.status.kubeProxyVersion` field for Node objects will be [marked as deprecated](https://github.com/kubernetes/enhancements/issues/4004) in v1.29 in preparation for its removal in a future release. This field is not accurate and is set by kubelet, which does not actually know the kube-proxy version, or even if kube-proxy is running.
-->
### 棄用針對 Node 的 `status.nodeInfo.kubeProxyVersion` 字段

在 v1.29 中，針對 Node 對象的 `.status.kubeProxyVersion` 字段將被
[標記爲棄用](https://github.com/kubernetes/enhancements/issues/4004)，
準備在未來某個發行版本中移除。這是因爲此字段並不準確，它由 kubelet 設置，
而 kubelet 實際上並不知道 kube-proxy 版本，甚至不知道 kube-proxy 是否在運行。

<!--
## Want to know more?

Deprecations are announced in the Kubernetes release notes. You can see the announcements of pending deprecations in the release notes for:
-->
## 瞭解更多

棄用信息是在 Kubernetes 發佈說明（Release Notes）中公佈的。你可以在以下版本的發佈說明中看到待棄用的公告：

* [Kubernetes v1.25](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.25.md#deprecation)
* [Kubernetes v1.26](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.26.md#deprecation)
* [Kubernetes v1.27](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.27.md#deprecation)
* [Kubernetes v1.28](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.28.md#deprecation)

<!--
We will formally announce the deprecations that come with [Kubernetes v1.29](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.29.md#deprecation) as part of the CHANGELOG for that release.

For information on the deprecation and removal process, refer to the official Kubernetes [deprecation policy](/docs/reference/using-api/deprecation-policy/#deprecating-parts-of-the-api) document.
-->
我們將在
[Kubernetes v1.29](https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.29.md#deprecation)
的 CHANGELOG 中正式宣佈與該版本相關的棄用信息。

有關棄用和移除流程的細節，參閱 Kubernetes
官方[棄用策略](/zh-cn/docs/reference/using-api/deprecation-policy/#deprecating-parts-of-the-api)文檔。
