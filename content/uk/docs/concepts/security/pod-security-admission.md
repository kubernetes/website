---
reviewers:
- tallclair
- liggitt
title: Pod Security Admission
description: >
  Огляд контролера Pod Security Admission, який може застосовувати Стандарти Безпеки Podʼів.
content_type: concept
weight: 20
---

<!-- overview -->

{{< feature-state for_k8s_version="v1.25" state="stable" >}}

Стандарти [безпеки Podʼів Kubernetes](/docs/concepts/security/pod-security-standards/) визначають різні рівні ізоляції для Podʼів. Ці стандарти дозволяють визначити, як ви хочете обмежувати поведінку Podʼів в чіткий, послідовний спосіб.

У Kubernetes є вбудований {{< glossary_tooltip text="контролер допуску" term_id="admission-controller" >}} _безпеки Pod_, щоб застосовувати Стандарти Безпеки Podʼів. Обмеження безпеки Podʼів застосовуються на рівні {{< glossary_tooltip text="просторі імен" term_id="namespace" >}} під час створення Podʼів.

### Вбудоване забезпечення Pod Security admission {#built-in-pod-security-admission-enforcement}

Ця сторінка є частиною документації Kubernetes v{{< skew currentVersion >}}. Якщо ви використовуєте іншу версію Kubernetes, перегляньте документацію для цієї версії.

<!-- body -->

## Рівні безпеки Podʼів {#pod-security-levels}

Забезпечення Pod Security admission ставить вимоги до [Контексту Безпеки](/docs/tasks/configure-pod-container/security-context/) Podʼа та інших повʼязаних полів відповідно до трьох рівнів, визначених [Стандартами безпеки Podʼів](/docs/concepts/security/pod-security-standards): `privileged` (привілейований), `baseline` (базовий) та `restricted` (обмежений). Для докладного огляду цих вимог дивіться сторінку [Стандартів безпеки Podʼів](/docs/concepts/security/pod-security-standards).

## Мітки Pod Security Admission для просторів імен

Після активації функції або встановлення вебхука ви можете налаштувати простори імен, щоб визначити режим контролю допуску, який ви хочете використовувати для безпеки Podʼа в кожному просторі імен. Kubernetes визначає набір {{< glossary_tooltip term_id="label" text="міток" >}}, які можна встановити, щоб визначити, який з попередньо визначених рівнів стандартів безпеки Podʼів ви хочете використовувати для простору імен. Вибрана вами мітка визначає дію, яку панель управління виконує, якщо виявлено потенційне порушення:

{{< table caption="Режими входу для безпеки Podʼа" >}}
Режим | Опис
:---------|:------------
**enforce** | Порушення політики призведе до відмови обслуговування Podʼа.
**audit** | Порушення політики спричинить додавання аудит-анотації до події, записаної в [аудит-лог](/docs/tasks/debug/debug-cluster/audit/), але в іншому випадку буде дозволено.
**warn** | Порушення політики спричинить попередження для користувача, але в іншому випадку буде дозволено.
{{< /table >}}

Простір імен може налаштувати будь-який або всі режими, або навіть встановити різний рівень для різних режимів.

Для кожного режиму існують дві позначки, які визначають використовувану політику:

```yaml
# Мітка рівня режиму вказує, який рівень політики застосовується для режиму.
#
# РЕЖИМ повинен бути одним з `enforce`, `audit` або `warn`.
# РІВЕНЬ повинен бути одним з `privileged`, `baseline` або `restricted`.
pod-security.kubernetes.io/<РЕЖИМ>: <РІВЕНЬ>

# Опціонально: позначка версії режиму, яку можна використовувати для привʼязки політики до
# версії, що поставляється з певною мінорною версією Kubernetes (наприклад, v{{< skew currentVersion >}}).
#
# РЕЖИМ повинен бути одним з `enforce`, `audit` або `warn`.
# ВЕРСІЯ повинна бути дійсною мінорною версією Kubernetes або `latest`.
pod-security.kubernetes.io/<РЕЖИМ>-version: <ВЕРСІЯ>
```

Перегляньте [Застосування стандартів безпеки Podʼів з використанням міток просторів імен](/docs/tasks/configure-pod-container/enforce-standards-namespace-labels), щоб побачити приклад використання.

## Ресурси робочого навантаження та шаблони Podʼа {#workload-resources-and-pod-templates}

Podʼи часто створюються не безпосередньо, а шляхом створення [обʼєкта робочого навантаження](/docs/concepts/workloads/controllers/), такого як {{< glossary_tooltip term_id="deployment" >}} або {{< glossary_tooltip term_id="job">}}. Обʼєкт робочого навантаження визначає _шаблон Podʼа_ та {{< glossary_tooltip term_id="controller" text="контролер" >}} для ресурсу робочого навантаження, який створює Podʼи на основі цього шаблону. Щоб вчасно виявляти порушення, обидва режими аудиту та попередження застосовуються до ресурсів робочого навантаження. Проте режим виконання **не** застосовується до ресурсів робочого навантаження, а лише до отриманих обʼєктів Podʼа.

## Виключення {#exemptions}

Ви можете визначити _Виключення_ з виконання політики безпеки Podʼа, щоб дозволити створення Podʼів, які інакше були б заборонені через політику, повʼязану з певним простором імен.

Виключення можна статично налаштувати в [конфігурації контролера допуску](/docs/tasks/configure-pod-container/enforce-standards-admission-controller/#configure-the-admission-controller).

Виключення повинні бути явно перераховані. Запити, які відповідають критеріям винятків, _ігноруються_ контролером допуску (всі поведінки `enforce`, `audit` та `warn` пропускаються). Винятків включають:

- **Usernames:** запити від користувачів за виключеним автентифікованих (або знеособлених) користувачів ігноруються.
- **RuntimeClassNames:** Podʼи та [ресурси робочого навантаження](#workload-resources-and-pod-templates), які вказують виключене імʼя класу runtime, ігноруються.
- **Namespaces:** Podʼи та [ресурси робочого навантаження](#workload-resources-and-pod-templates) у виключеному просторі імен ігноруються.

{{< caution >}}

Більшість Podʼів створюються контролером у відповідь [ресурсу робочого навантаження](#workload-resources-and-pod-templates), що означає, що виключення кінцевого користувача буде застосовуватися лише до нього при створенні Podʼів безпосередньо, але не при створенні ресурсу робочого навантаження. Облікові записи служби контролера (наприклад, `system:serviceaccount:kube-system:replicaset-controller`) зазвичай не повинні бути виключені, оскільки це неявно виключить будь-якого користувача, який може створювати відповідний ресурс робочого навантаження.

{{< /caution >}}

Оновлення наступних полів Podʼа виключаються з перевірки політики, що означає, що якщо запит на оновлення Podʼа змінює лише ці поля, його не буде відхилено, навіть якщо Pod порушує поточний рівень політики:

- Будь-які оновлення метаданих **виключають** зміну анотацій seccomp або AppArmor:
  - `seccomp.security.alpha.kubernetes.io/pod` (застарілий)
  - `container.seccomp.security.alpha.kubernetes.io/*` (застарілий)
  - `container.apparmor.security.beta.kubernetes.io/*`
- Дійсні оновлення `.spec.activeDeadlineSeconds`
- Дійсні оновлення `.spec.tolerations`

## Метрики {#metrics}

Ось метрики Prometheus, які надаються kube-apiserver:

- `pod_security_errors_total`: Ця метрика показує кількість помилок, які перешкоджають нормальній оцінці. Нефатальні помилки можуть призвести до використання останнього обмеженого профілю для виконання.
- `pod_security_evaluations_total`: Ця метрика показує кількість оцінок політики, що відбулися, не враховуючи ігнорованих або запитів винятків під час експортування.
- `pod_security_exemptions_total`: Ця метрика показує кількість запитів винятків, не враховуючи ігноровані або запити, що не входять в область застосування.

## {{% heading "whatsnext" %}}

- [Стандарти безпеки Podʼів](/docs/concepts/security/pod-security-standards)
- [Застосування стандартів безпеки Podʼів](/docs/setup/best-practices/enforcing-pod-security-standards)
- [Застосування стандартів безпеки Podʼів за допомогою вбудованого контролера допуску](/docs/tasks/configure-pod-container/enforce-standards-admission-controller)
- [Застосування стандартів безпеки Podʼів з мітками простору імен](/docs/tasks/configure-pod-container/enforce-standards-namespace-labels)

Якщо ви використовуєте старішу версію Kubernetes і хочете оновитися до версії Kubernetes, яка не містить політик безпеки Podʼа, прочитайте [перехід від PodSecurityPolicy до вбудованого контролера допуску для безпеки Podʼа](/docs/tasks/configure-pod-container/migrate-from-psp).
