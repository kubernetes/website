---
title: "Архітектура кластера"
weight: 30
description: >
  Архітектурні концепції в основі Kubernetes.
---

Кластер Kubernetes складається з панелі управління та набору робочих машин, які називаються вузлами, що запускають контейнеризовані застосунки. Кожен кластер потребує принаймні одного робочого вузла для запуску Podʼів.

Робочі вузли розміщують Podʼи, які є компонентами робочого навантаження застосунку. Панель управління керує робочими вузлами та Podʼами в кластері. В операційних середовищах панель управління зазвичай працює на кількох компʼютерах, а кластер зазвичай має кілька вузлів, забезпечуючи відмовостійкість та високу доступність.

Цей документ описує різні компоненти, які вам потрібні для повноцінного та працездатного кластера Kubernetes.

{{< figure src="/images/docs/kubernetes-cluster-architecture.svg" alt="Панель управління (kube-apiserver, etcd, kube-controller-manager, kube-scheduler) та кілька вузлів. Кожен вузол запускає kubelet та kube-proxy." caption="Схема 1. Компоненти кластера Kubernetes." class="diagram-large" >}}

{{< details summary="Про архітектуру" >}}
На схемі 1 представлено приклад еталонної архітектури кластера Kubernetes. Фактичний розподіл компонентів може змінюватися залежно від конкретних налаштувань кластера та вимог.

На схемі на кожному вузлі запущено компонент [`kube-proxy`](#kube-proxy). Вам потрібен компонент мережевого проксі на кожному вузлі, щоб гарантувати, що {{< glossary_tooltip text="Service" term_id="service">}} API та пов'язані з ним дії були доступні у вашій кластерній мережі. Втім, деякі мережеві втулки надають власну, сторонню реалізацію проксі-сервера. Коли ви використовуєте такий мережевий втулок, вузлу не потрібно запускати `kube-proxy`.
{{< /details >}}

## Компоненти панелі управління {#control-plane-components}

Компоненти панелі управління приймають глобальні рішення щодо кластера (наприклад, планування), а також виявляють та реагують на події в кластері (наприклад, запуск нового {{< glossary_tooltip text="Podʼа" term_id="pod">}}, коли умова поля `{{< glossary_tooltip text="replicas" term_id="replica" >}}` в Deployment не виконується).

Компоненти панелі управління можуть запускатися на будь-якій машині у кластері. Однак для спрощення, скрипти налаштування зазвичай запускають всі компоненти панелі управління на одній машині та не запускають контейнерів користувача на цій машині. Див. [Створення кластерів з високою доступністю за допомогою kubeadm](/docs/setup/production-environment/tools/kubeadm/high-availability/) для прикладу налаштування панелі управління, яка працює на кількох машинах.

### kube-apiserver

{{< glossary_definition term_id="kube-apiserver" length="all" >}}

### etcd

{{< glossary_definition term_id="etcd" length="all" >}}

### kube-scheduler

{{< glossary_definition term_id="kube-scheduler" length="all" >}}

### kube-controller-manager

{{< glossary_definition term_id="kube-controller-manager" length="all" >}}

Існує багато різних типів контролерів. Деякі приклади:

- Контролер вузлів: відповідає за виявлення та реагування, коли вузли виходять з ладу.
- Контролер завдань: відстежує обʼєкти Job, що представляють одноразові завдання, а потім створює Podʼи для виконання цих завдань, які існують до їх завершення.
- Контролер EndpointSlice: заповнює обʼєкти EndpointSlice (для забезпечення звʼязку між Serviceʼами та Podʼами).
- Контролер службових облікових записів: створює стандартні ServiceAccounts для нових просторів імен.

Наведений вище список не є вичерпним.

### cloud-controller-manager

{{< glossary_definition term_id="cloud-controller-manager" length="short" >}}

cloud-controller-manager запускає лише ті контролери, які специфічні для вашого хмарного провайдера. Якщо ви використовуєте Kubernetes у себе на підприємстві або в навчальному середовищі всередині вашого ПК, кластер не матиме cloud-controller-manager.

Як і kube-controller-manager, cloud-controller-manager обʼєднує кілька логічно незалежних циклів керування в один бінарний файл, який ви запускаєте як один процес. Ви можете масштабувати його горизонтально (запускати більше однієї копії) для покращення продуктивності або для підвищення стійкості до збоїв.

Наступні контролери можуть мати залежності від хмарного провайдера:

- Контролер вузлів: перевіряє у хмарного провайдера, чи було видалено вузол у хмарі після того, як він перестав відповідати.
- Контролер маршрутів: налаштовує маршрути в основній хмарній інфраструктурі.
- Контролер сервісів: створює, оновлює та видаляє балансувальників навантаження хмарного провайдера.

---

## Компоненти вузлів {#node-components}

Компоненти вузлів працюють на кожному вузлі, підтримуючи роботу Podʼів та забезпечуючи середовище виконання Kubernetes.

### kubelet

{{< glossary_definition term_id="kubelet" length="all" >}}

### kube-proxy (опційно) {#kube-proxy}

{{< glossary_definition term_id="kube-proxy" length="all" >}}

Якщо ви використовуєте [мережевий втулок](#network-plugins), який самостійно реалізує пересилання пакетів для сервісів та надає еквівалентну поведінку kube-proxy, то вам не потрібно запускати kube-proxy на вузлах вашого кластера.

### Рушій виконання контейнерів {#container-runtime}

{{< glossary_definition term_id="container-runtime" length="all" >}}

## Надбудови {#addons}

Надбудови використовують ресурси Kubernetes ({{< glossary_tooltip term_id="daemonset" >}}, {{< glossary_tooltip term_id="deployment" >}} тощо) для реалізації функцій кластера. Оскільки вони надають функції на рівні кластера, ресурси, що належать надбудовам, розміщуються в просторі імен `kube-system`.

Вибрані застосунки описані нижче; для розширеного списку доступних надбудов дивіться [Надбудови](/docs/concepts/cluster-administration/addons/).

### DNS

Хоча інші надбудови не є строго необхідними, всі кластери Kubernetes повинні мати [кластерний DNS](/docs/concepts/services-networking/dns-pod-service/), оскільки багато прикладів залежать від нього.

Кластерний DNS — це DNS-сервер, який доповнює інші DNS-сервери у вашому середовищі та обслуговує DNS-записи для сервісів Kubernetes.

Контейнери, запущені за допомогою Kubernetes, автоматично включають цей DNS-сервер у свої DNS-запити.

### Вебінтерфейс (Dashboard) {#web-ui-dashboard}

[Dashboard](/docs/tasks/access-application-cluster/web-ui-dashboard/) — це універсальний вебінтерфейс для кластерів Kubernetes. Він дозволяє користувачам керувати та розвʼязувати проблеми з застосунками, що працюють у кластері, а також з самим кластером.

### Моніторинг ресурсів контейнерів {#container-resource-monitoring}

[Моніторинг ресурсів контейнерів](/docs/tasks/debug/debug-cluster/resource-usage-monitoring/) записує загальні метрики часу для контейнерів у центральну базу даних та надає інтерфейс для перегляду цих даних.

### Логування на рівні кластера {#cluster-level-logging}

Механізм [логування на рівні кластера](/docs/concepts/cluster-administration/logging/) відповідає за збереження логів контейнерів в центральному сховищі логів з інтерфейсом пошуку та перегляду.

### Мережеві втулки {#network-plugins}

[Мережеві втулки](/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins) — це програмні компоненти, які реалізують специфікацію інтерфейсу мережі контейнерів (CNI). Вони відповідають за виділення IP-адрес Podʼам та забезпечення їх звʼязку між собою у кластері.

## Варіації архітектури {#architecture-variations}

Хоча основні компоненти Kubernetes залишаються незмінними, способи їх розгортання та управління можуть відрізнятися. Розуміння цих варіацій є ключовим для проєктування та підтримки кластерів Kubernetes, що відповідають специфічним операційним потребам.

### Варіанти розгортання панелі управління {#control-plane-deployment-options}

Компоненти панелі управління можна розгортати кількома способами:

Традиційне розгортання:
: Компоненти панелі управління працюють безпосередньо на виділених машинах або віртуальних машинах, часто керованих як служби systemd.

Статичні Podʼи:
: Компоненти панелі управління розгортаються як статичні Podʼи, керовані kubelet на певних вузлах. Це поширений підхід, який використовують такі інструменти, як kubeadm.

Самообслуговування:
: Панель управління працює як Podʼи у самому кластері Kubernetes, яким керують Deployments та StatefulSets або інші примітиви Kubernetes.

Керовані сервіси Kubernetes:
: Хмарні провайдери часто абстрагують панель управління, керуючи її компонентами як частиною послуги, яку вони надають.

### Розміщення робочих навантажень {#workload-placement-considerations}

Розміщення робочих навантажень, включаючи компоненти панелі управління, може варіюватися залежно від розміру кластера, вимог до продуктивності та операційних політик:

- У менших або розробницьких кластерах компоненти панелі управління та робочі навантаження користувачів можуть працювати на одних і тих же вузлах.
- Великі операційні кластери часто виділяють певні вузли для компонентів панелі управління, відокремлюючи їх від робочих навантажень користувачів.
- Деякі організації запускають критично важливі застосунки або інструменти моніторингу на вузлах панелі управління.

### Інструменти управління кластером {#cluster-management-tools}

Такі інструменти, як kubeadm, kops та Kubespray, пропонують різні підходи до розгортання та управління кластерами, кожен з яких має свій метод розташування та управління компонентами.

### Налаштування та розширюваність {#customization-and-extensibility}

Архітектура Kubernetes дозволяє значну кастомізацію:

- Власні планувальники можна розгортати паралельно зі стандартним планувальником Kubernetes або замінювати його повністю.
- API-сервери можна розширювати за допомогою CustomResourceDefinitions та API Aggregation.
- Хмарні провайдери можуть глибоко інтегруватися з Kubernetes за допомогою cloud-controller-manager.

Гнучкість архітектури Kubernetes дозволяє організаціям налаштовувати свої кластери відповідно до специфічних потреб, балансуючи фактори, такі як операційна складність, продуктивність та управлінські витрати.

## {{% heading "whatsnext" %}}

Дізнайтеся більше про:

- [Вузли](/docs/concepts/architecture/nodes/) та [їх комунікацію](/docs/concepts/architecture/control-plane-node-communication/) з панеллю управління.
- [Контролери](/docs/concepts/architecture/controller/) Kubernetes.
- [kube-scheduler](/docs/concepts/scheduling-eviction/kube-scheduler/), який є стандартним планувальником для Kubernetes.
- Офіційну [документацію Etcd](https://etcd.io/docs/).
- Декілька [контейнерних рушіїв](/docs/setup/production-environment/container-runtimes/) у Kubernetes.
- Інтеграцію з хмарними провайдерами за допомогою [cloud-controller-manager](/docs/concepts/architecture/cloud-controller/).
- Команди [kubectl](/docs/reference/generated/kubectl/kubectl-commands/).
