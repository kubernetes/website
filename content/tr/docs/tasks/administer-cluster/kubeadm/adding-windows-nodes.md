---
title: Windows işçi düğümleri ekleme
content_type: task
weight: 11
---

<!-- overview -->

{{< feature-state for_k8s_version="v1.18" state="beta" >}}

Bu sayfa, bir kubeadm kümesine Windows işçi düğümleri eklemeyi açıklar.

## {{% heading "prerequisites" %}}

* Yönetici erişimi olan çalışan bir [Windows Server 2022](https://www.microsoft.com/cloud-platform/windows-server-pricing)
(veya daha yüksek) örneği.
* `kubeadm init` tarafından oluşturulan ve belgede yer alan adımları izleyen çalışan bir kubeadm kümesi
[kubeadm ile bir küme oluşturma](/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/).

<!-- steps -->

## Windows işçi düğümleri ekleme

{{< note >}}
Bir kümeye Windows işçi düğümleri eklemeyi kolaylaştırmak için, https://sigs.k8s.io/sig-windows-tools deposundan PowerShell betikleri kullanılır.
{{< /note >}}

Her makine için aşağıdakileri yapın:

1. Makinede bir PowerShell oturumu açın.
1. Yönetici veya ayrıcalıklı bir kullanıcı olduğunuzdan emin olun.

Ardından aşağıda belirtilen adımları izleyin.

### containerd yükleme

{{% thirdparty-content %}}

containerd yüklemek için önce aşağıdaki komutu çalıştırın:

  ```PowerShell
  curl.exe -LO https://raw.githubusercontent.com/kubernetes-sigs/sig-windows-tools/master/hostprocess/Install-Containerd.ps1
  ```

Ardından aşağıdaki komutu çalıştırın, ancak önce `CONTAINERD_VERSION` değerini [containerd deposundan](https://github.com/containerd/containerd/releases) alınan güncel bir sürümle değiştirin.
Sürümün `v` öneki olmamalıdır. Örneğin, `v1.7.22` yerine `1.7.22` kullanın:

  ```PowerShell
  .\Install-Containerd.ps1 -ContainerDVersion CONTAINERD_VERSION
  ```

* `Install-Containerd.ps1` için `netAdapterName` gibi diğer parametreleri ihtiyacınıza göre ayarlayın.
* Makineniz Hyper-V'yi desteklemiyorsa ve Hyper-V izole edilmiş kapsayıcıları barındıramıyorsa `skipHypervisorSupportCheck` ayarını yapın.
* `Install-Containerd.ps1` isteğe bağlı parametrelerini `CNIBinPath` ve/veya `CNIConfigPath` olarak değiştirirseniz, yüklenen Windows CNI eklentisini eşleşen değerlerle yapılandırmanız gerekecektir.

### kubeadm ve kubelet yükleme

kubeadm ve kubelet yüklemek için aşağıdaki komutları çalıştırın:

  ```PowerShell
  curl.exe -LO https://raw.githubusercontent.com/kubernetes-sigs/sig-windows-tools/master/hostprocess/PrepareNode.ps1
  .\PrepareNode.ps1 -KubernetesVersion v{{< skew currentVersion >}}
  ```

* Gerekirse `PrepareNode.ps1` parametresi `KubernetesVersion`'ı ayarlayın.

### `kubeadm join` çalıştırma

`kubeadm init` tarafından çıktılan komutu çalıştırın. Örneğin:

  ```bash
  kubeadm join --token <token> <control-plane-host>:<control-plane-port> --discovery-token-ca-cert-hash sha256:<hash>
  ```

#### kubeadm join hakkında ek bilgi

{{< note >}}
`<control-plane-host>:<control-plane-port>` için bir IPv6 çiftini belirtmek için, IPv6 adresi köşeli parantez içine alınmalıdır, örneğin: `[2001:db8::101]:2073`.
{{< /note >}}

Token'ınız yoksa, kontrol düzlemi düğümünde aşağıdaki komutu çalıştırarak alabilirsiniz:

```bash
# Bu komutu bir kontrol düzlemi düğümünde çalıştırın
sudo kubeadm token list
```

Çıktı şu şekilde benzer olacaktır:

```console
TOKEN                    TTL  EXPIRES              USAGES           DESCRIPTION            EXTRA GROUPS
8ewj1p.9r9hcjoqgajrj4gi  23h  2018-06-12T02:51:28Z authentication,  The default bootstrap  system:
                                                   signing          token generated by     bootstrappers:
                                                                    'kubeadm init'.        kubeadm:
                                                                                           default-node-token
```

Varsayılan olarak, düğüm katılım token'ları 24 saat sonra sona erer. Mevcut token süresi dolduktan sonra kümeye bir düğüm ekliyorsanız, kontrol düzlemi düğümünde aşağıdaki komutu çalıştırarak yeni bir token oluşturabilirsiniz:

```bash
# Bu komutu bir kontrol düzlemi düğümünde çalıştırın
sudo kubeadm token create
```

Çıktı şu şekilde benzer olacaktır:

```console
5didvk.d09sbcov8ph2amjw
```

`--discovery-token-ca-cert-hash` değerine sahip değilseniz, kontrol düzlemi düğümünde aşağıdaki komutları çalıştırarak alabilirsiniz:

```bash
sudo cat /etc/kubernetes/pki/ca.crt | openssl x509 -pubkey  | openssl rsa -pubin -outform der 2>/dev/null | \
   openssl dgst -sha256 -hex | sed 's/^.* //'
```

Çıktı şu şekilde benzer olacaktır:

```console
8cb2de97839780a412b93877f8507ad6c94f73add17d5d7058e91741c9d5ec78
```

`kubeadm join` komutunun çıktısı şu şekilde görünecektir:

```
[preflight] Running pre-flight checks

... (katılım iş akışının günlük çıktısı) ...

Düğüm katılımı tamamlandı:
* Sertifika imzalama isteği kontrol düzlemine gönderildi ve yanıt alındı.
* Kubelet yeni güvenli bağlantı ayrıntıları hakkında bilgilendirildi.

Bu makinenin katıldığını görmek için kontrol düzleminde 'kubectl get nodes' komutunu çalıştırın.
```

Birkaç saniye sonra, `kubectl get nodes` çıktısında bu düğümü fark etmelisiniz.
(örneğin, bir kontrol düzlemi düğümünde `kubectl` çalıştırın).

### Ağ yapılandırması

Linux ve Windows düğümleri ile karışık kümelerde CNI kurulumu, bir manifest dosyasında `kubectl apply` çalıştırmaktan daha fazla adım gerektirir. Ayrıca, kontrol düzlemi düğümlerinde çalışan CNI eklentisi, Windows işçi düğümlerinde çalışan CNI eklentisini destekleyecek şekilde hazırlanmalıdır.

{{% thirdparty-content %}}

Şu anda yalnızca birkaç CNI eklentisi Windows'u desteklemektedir. Aşağıda bunlar için bireysel kurulum talimatlarını bulabilirsiniz:
* [Flannel](https://sigs.k8s.io/sig-windows-tools/guides/flannel.md)
* [Calico](https://docs.tigera.io/calico/latest/getting-started/kubernetes/windows-calico/)

### Windows için kubectl yükleme (isteğe bağlı) {#install-kubectl}

Bkz. [Windows'ta kubectl yükleme ve kurma](/docs/tasks/tools/install-kubectl-windows/).

## {{% heading "whatsnext" %}}

* [Linux işçi düğümleri ekleme](/docs/tasks/administer-cluster/kubeadm/adding-linux-nodes/) konusuna bakın.
